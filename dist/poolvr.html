<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">

    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="shortcut icon" href="favicon.ico">

    <title>poolvr</title>

    <link rel="stylesheet" href="poolvr.css">

<script>
var WebVRConfig = {
  "MOUSE_KEYBOARD_CONTROLS_DISABLED": false,
  "KEYBOARD_CONTROLS_DISABLED": true,
  "K_FILTER": 0.98,
  "YAW_ONLY": false,
  "LEAP_MOTION_HOST": "192.168.1.200",
  "ENABLE_LEAP_MOTION": false,
  "PREDICTION_TIME_S": 0.02,
  "TOUCH_PANNER_DISABLED": false,
  "FORCE_ENABLE_VR": false
};

var POOLVR = {
  "version": "0.2.6",
  "config": {
    "L_table": 2.3368,
    "synthSpeakerVolume": 0.5,
    "useTextGeomLogger": true,
    "gravity": 9.8,
    "H_table": 0.77,
    "useShadowMap": false,
    "toolOptions": {
      "tipShape": "Cylinder",
      "numSegments": 8,
      "tipLength": 0.37,
      "tipRadius": 0.01,
      "interactionPlaneOpacity": 0.22,
      "toolLength": 0.37,
      "offset": [
        0,
        0,
        0.185
      ],
      "toolRadius": 0.01,
      "useImplicitCylinder": true,
      "toolMass": 0.54
    },
    "H_ceiling": 2.4383999999999997,
    "ball_diameter": 0.05715,
    "useBasicMaterials": true,
    "useSpotLight": true,
    "usePointLight": false
  }
};

var THREEPY_SCENE = {"metadata": {"type": "Object", "generator": "three.py", "version": 4.4}, "images": [], "object": {"type": "Scene", "position": [0.0, 0.0, 0.0], "children": [{"type": "Object3D", "position": [0.0, 0.0, 0.0], "children": [{"type": "Mesh", "position": [0.0, 0.7573, 0.0], "children": [], "rotation": [0.0, 0.0, 0.0], "name": "playableSurfaceMesh", "uuid": "e0e7ebb7-adc1-4ce3-9f3b-891789743200", "material": "33f8bc23-c118-4453-8d7f-d1814c4732f7", "userData": {"cannonData": {"mass": 0, "shapes": ["Box"]}}, "geometry": "d0e84f2f-5971-42d0-b471-4b95c506ab7e", "scale": [1.0, 1.0, 1.0], "receiveShadow": true}, {"type": "Mesh", "position": [0.0, 0.7702, 0.5842], "children": [], "rotation": [-1.5707963267948966, 0.0, 0.3141592653589793], "name": "unnamed Mesh 0", "uuid": "c634f4cd-ec32-4a52-95f4-18de7efa3f7d", "material": "939a8af2-ca74-4cec-8e88-7e1cba788613", "geometry": "062a8b4a-0a2f-43fb-b655-47d8bff2a570", "scale": [1.0, 1.0, 1.0], "receiveShadow": true}, {"type": "Mesh", "position": [0.0, 0.77, 1.143], "children": [], "rotation": [0.0, 0.0, 0.0], "name": "headCushionMesh", "uuid": "7f8a017e-59ae-4a4a-ba9c-c0176b378bd2", "material": "8b682946-c297-40aa-b4b7-7b26a666222b", "userData": {"cannonData": {"mass": 0, "faces": [[3, 2, 1, 0], [4, 5, 6, 7], [0, 1, 5, 4], [1, 2, 6, 5], [2, 3, 7, 6], [7, 3, 0, 4]], "shapes": ["ConvexPolyhedron"]}}, "geometry": "15ac560d-7d42-4af6-87dd-783158bc95f8", "scale": [1.0, 1.0, 1.0], "receiveShadow": true}, {"type": "Mesh", "position": [0.0, 0.77, -1.143], "children": [], "rotation": [0.0, 3.141592653589793, 0.0], "name": "footCushionMesh", "uuid": "13103f50-5710-4b7b-8762-56c9058c78fd", "material": "8b682946-c297-40aa-b4b7-7b26a666222b", "userData": {"cannonData": {"mass": 0, "faces": [[3, 2, 1, 0], [4, 5, 6, 7], [0, 1, 5, 4], [1, 2, 6, 5], [2, 3, 7, 6], [7, 3, 0, 4]], "shapes": ["ConvexPolyhedron"]}}, "geometry": "15ac560d-7d42-4af6-87dd-783158bc95f8", "scale": [1.0, 1.0, 1.0], "receiveShadow": true}, {"type": "Mesh", "position": [-0.5588000000000001, 0.77, 0.5842], "children": [], "rotation": [0.0, -1.5707963267948966, 0.0], "name": "leftHeadCushionMesh", "uuid": "631a74bf-b189-44a8-b509-e17456eb7dbb", "material": "8b682946-c297-40aa-b4b7-7b26a666222b", "userData": {"cannonData": {"mass": 0, "faces": [[3, 2, 1, 0], [4, 5, 6, 7], [0, 1, 5, 4], [1, 2, 6, 5], [2, 3, 7, 6], [7, 3, 0, 4]], "shapes": ["ConvexPolyhedron"]}}, "geometry": "f7f465ae-e31a-4311-bdc0-5eab6dce219d", "scale": [1.0, 1.0, 1.0], "receiveShadow": true}, {"type": "Mesh", "position": [-0.5588000000000001, 0.77, -0.5842], "children": [], "rotation": [0.0, -1.5707963267948966, 0.0], "name": "leftFootCushionMesh", "uuid": "12a3b0f0-0db4-4c1e-aaa0-e4554f4781b6", "material": "8b682946-c297-40aa-b4b7-7b26a666222b", "userData": {"cannonData": {"mass": 0, "faces": [[3, 2, 1, 0], [4, 5, 6, 7], [0, 1, 5, 4], [1, 2, 6, 5], [2, 3, 7, 6], [7, 3, 0, 4]], "shapes": ["ConvexPolyhedron"]}}, "geometry": "723ad624-820c-44f6-af62-27f7de35a61f", "scale": [1.0, 1.0, 1.0], "receiveShadow": true}, {"type": "Mesh", "position": [0.5588000000000001, 0.77, 0.5842], "children": [], "rotation": [0.0, 1.5707963267948966, 0.0], "name": "rightHeadCushionMesh", "uuid": "d481011d-0fa9-4ee7-936c-171470b6dad7", "material": "8b682946-c297-40aa-b4b7-7b26a666222b", "userData": {"cannonData": {"mass": 0, "faces": [[3, 2, 1, 0], [4, 5, 6, 7], [0, 1, 5, 4], [1, 2, 6, 5], [2, 3, 7, 6], [7, 3, 0, 4]], "shapes": ["ConvexPolyhedron"]}}, "geometry": "723ad624-820c-44f6-af62-27f7de35a61f", "scale": [1.0, 1.0, 1.0], "receiveShadow": true}, {"type": "Mesh", "position": [0.5588000000000001, 0.77, -0.5842], "children": [], "rotation": [0.0, 1.5707963267948966, 0.0], "name": "rightFootCushionMesh", "uuid": "4365393b-c896-41d1-ab0e-52b94a3a76e6", "material": "8b682946-c297-40aa-b4b7-7b26a666222b", "userData": {"cannonData": {"mass": 0, "faces": [[3, 2, 1, 0], [4, 5, 6, 7], [0, 1, 5, 4], [1, 2, 6, 5], [2, 3, 7, 6], [7, 3, 0, 4]], "shapes": ["ConvexPolyhedron"]}}, "geometry": "f7f465ae-e31a-4311-bdc0-5eab6dce219d", "scale": [1.0, 1.0, 1.0], "receiveShadow": true}, {"type": "Mesh", "position": [0.0, 0.79268140625, 1.2065000000000001], "children": [], "rotation": [0.0, 0.0, 0.0], "name": "headRailMesh", "uuid": "5571677e-9b69-4f6b-a941-8b3ebccf6e0a", "material": "24655c48-1f92-41a8-bea3-d32ac605c82f", "userData": {"cannonData": {"mass": 0, "shapes": ["Box"]}}, "geometry": "b96da5e2-2b4b-4644-b756-4f6d340cdea6", "scale": [1.0, 1.0, 1.0], "receiveShadow": true}, {"type": "Mesh", "position": [0.0, 0.79268140625, -1.2065000000000001], "children": [], "rotation": [0.0, 3.141592653589793, 0.0], "name": "footRailMesh", "uuid": "758a2a54-2be2-42ff-bd67-83bb6480fa1b", "material": "24655c48-1f92-41a8-bea3-d32ac605c82f", "userData": {"cannonData": {"mass": 0, "shapes": ["Box"]}}, "geometry": "b96da5e2-2b4b-4644-b756-4f6d340cdea6", "scale": [1.0, 1.0, 1.0], "receiveShadow": true}, {"type": "Mesh", "position": [-0.6223000000000001, 0.79268140625, 0.5842], "children": [], "rotation": [0.0, 1.5707963267948966, 0.0], "name": "leftHeadRailMesh", "uuid": "dead62e7-b92a-4c93-ad8f-22327977e0f8", "material": "24655c48-1f92-41a8-bea3-d32ac605c82f", "userData": {"cannonData": {"mass": 0, "shapes": ["Box"]}}, "geometry": "b96da5e2-2b4b-4644-b756-4f6d340cdea6", "scale": [1.0, 1.0, 1.0], "receiveShadow": true}, {"type": "Mesh", "position": [0.6223000000000001, 0.79268140625, 0.5842], "children": [], "rotation": [0.0, 1.5707963267948966, 0.0], "name": "rightHeadRailMesh", "uuid": "829d9a44-2487-4c6e-8d85-0340611cce84", "material": "24655c48-1f92-41a8-bea3-d32ac605c82f", "userData": {"cannonData": {"mass": 0, "shapes": ["Box"]}}, "geometry": "b96da5e2-2b4b-4644-b756-4f6d340cdea6", "scale": [1.0, 1.0, 1.0], "receiveShadow": true}, {"type": "Mesh", "position": [-0.6223000000000001, 0.79268140625, -0.5842], "children": [], "rotation": [0.0, 1.5707963267948966, 0.0], "name": "leftFootRailMesh", "uuid": "a6931537-a6c8-4c2a-b068-054dae1aec00", "material": "24655c48-1f92-41a8-bea3-d32ac605c82f", "userData": {"cannonData": {"mass": 0, "shapes": ["Box"]}}, "geometry": "b96da5e2-2b4b-4644-b756-4f6d340cdea6", "scale": [1.0, 1.0, 1.0], "receiveShadow": true}, {"type": "Mesh", "position": [0.6223000000000001, 0.79268140625, -0.5842], "children": [], "rotation": [0.0, 1.5707963267948966, 0.0], "name": "rightFootRailMesh", "uuid": "5fa0f24a-25ef-406f-bbdd-709747d27b06", "material": "24655c48-1f92-41a8-bea3-d32ac605c82f", "userData": {"cannonData": {"mass": 0, "shapes": ["Box"]}}, "geometry": "b96da5e2-2b4b-4644-b756-4f6d340cdea6", "scale": [1.0, 1.0, 1.0], "receiveShadow": true}], "rotation": [0.0, 0.0, 0.0], "name": "poolTable", "scale": [1.0, 1.0, 1.0], "uuid": "dff42900-ede0-40da-95d9-6d6f3cba9a7a"}, {"type": "Mesh", "position": [0.0, 0.0, 0.0], "children": [], "rotation": [-1.5707963267948966, 0.0, 0.0], "name": "floorMesh", "uuid": "39c42081-21fe-4ebd-a798-940e3f5faec0", "material": "23bff90f-29b7-41db-b538-dedcae9a80d4", "userData": {"cannonData": {"mass": 0, "shapes": ["Plane"]}}, "geometry": "b2f1dac9-0d08-4a39-9ffb-e4eb174e798e", "scale": [1.0, 1.0, 1.0]}], "rotation": [0.0, 0.0, 0.0], "name": "unnamed Scene 0", "scale": [1.0, 1.0, 1.0], "uuid": "887af12b-f8da-45b4-8a3d-3ec0fd2b3064"}, "materials": [{"type": "MeshPhongMaterial", "color": 43520, "shading": 1, "shininess": 5, "name": "surfaceMaterial", "uuid": "33f8bc23-c118-4453-8d7f-d1814c4732f7"}, {"type": "MeshBasicMaterial", "name": "floorMaterial", "uuid": "23bff90f-29b7-41db-b538-dedcae9a80d4", "color": 8704}, {"type": "MeshPhongMaterial", "color": 165956, "shading": 1, "shininess": 5, "name": "cushionMaterial", "uuid": "8b682946-c297-40aa-b4b7-7b26a666222b"}, {"type": "MeshPhongMaterial", "name": "headSpotMaterial", "shading": 1, "uuid": "939a8af2-ca74-4cec-8e88-7e1cba788613", "color": 7829367}, {"type": "MeshPhongMaterial", "color": 14525440, "shading": 1, "shininess": 10, "name": "railMaterial", "uuid": "24655c48-1f92-41a8-bea3-d32ac605c82f"}], "textures": [], "geometries": [{"type": "BufferGeometry", "name": "headCushionGeom", "data": {"attributes": {"position": {"type": "Float32Array", "array": [-0.5130800000000001, 0.0, 0.0254, 0.5130800000000001, 0.0, 0.0254, 0.44718954123773624, 0.0, -0.02286, -0.44718954123773624, 0.0, -0.02286, -0.5130800000000001, 0.0453628125, 0.0254, 0.5130800000000001, 0.0453628125, 0.0254, 0.44718954123773624, 0.03629025, -0.0254, -0.44718954123773624, 0.03629025, -0.0254], "itemSize": 3}}, "index": {"type": "Uint16Array", "array": [3, 2, 1, 3, 1, 0, 4, 5, 6, 4, 6, 7, 0, 1, 5, 0, 5, 4, 1, 2, 6, 1, 6, 5, 2, 3, 7, 2, 7, 6, 7, 3, 0, 7, 0, 4], "itemSize": 1}}, "uuid": "15ac560d-7d42-4af6-87dd-783158bc95f8"}, {"type": "PlaneBufferGeometry", "height": 6, "width": 6, "widthSegments": 1, "name": "unnamed PlaneBufferGeometry 0", "uuid": "b2f1dac9-0d08-4a39-9ffb-e4eb174e798e", "heightSegments": 1}, {"type": "BufferGeometry", "name": "rightHeadCushionGeom", "data": {"attributes": {"position": {"type": "Float32Array", "array": [-0.5130800000000001, 0.0, 0.0254, 0.5130800000000001, 0.0, 0.0254, 0.49029477061886817, 0.0, -0.02286, -0.44718954123773624, 0.0, -0.02286, -0.5130800000000001, 0.0453628125, 0.0254, 0.5130800000000001, 0.0453628125, 0.0254, 0.49029477061886817, 0.03629025, -0.0254, -0.44718954123773624, 0.03629025, -0.0254], "itemSize": 3}}, "index": {"type": "Uint16Array", "array": [3, 2, 1, 3, 1, 0, 4, 5, 6, 4, 6, 7, 0, 1, 5, 0, 5, 4, 1, 2, 6, 1, 6, 5, 2, 3, 7, 2, 7, 6, 7, 3, 0, 7, 0, 4], "itemSize": 1}}, "uuid": "723ad624-820c-44f6-af62-27f7de35a61f"}, {"type": "BufferGeometry", "name": "leftHeadCushionGeom", "data": {"attributes": {"position": {"type": "Float32Array", "array": [-0.5130800000000001, 0.0, 0.0254, 0.5130800000000001, 0.0, 0.0254, 0.44718954123773624, 0.0, -0.02286, -0.49029477061886817, 0.0, -0.02286, -0.5130800000000001, 0.0453628125, 0.0254, 0.5130800000000001, 0.0453628125, 0.0254, 0.44718954123773624, 0.03629025, -0.0254, -0.49029477061886817, 0.03629025, -0.0254], "itemSize": 3}}, "index": {"type": "Uint16Array", "array": [3, 2, 1, 3, 1, 0, 4, 5, 6, 4, 6, 7, 0, 1, 5, 0, 5, 4, 1, 2, 6, 1, 6, 5, 2, 3, 7, 2, 7, 6, 7, 3, 0, 7, 0, 4], "itemSize": 1}}, "uuid": "f7f465ae-e31a-4311-bdc0-5eab6dce219d"}, {"type": "BoxBufferGeometry", "height": 0.0453628125, "widthSegments": 1, "name": "unnamed BoxBufferGeometry 1", "depthSegments": 1, "depth": 0.07619999999999999, "width": 1.0261600000000002, "heightSegments": 1, "uuid": "b96da5e2-2b4b-4644-b756-4f6d340cdea6"}, {"type": "BoxBufferGeometry", "height": 0.0254, "widthSegments": 1, "name": "unnamed BoxBufferGeometry 0", "depthSegments": 1, "depth": 2.2352000000000003, "width": 1.0668000000000002, "heightSegments": 1, "uuid": "d0e84f2f-5971-42d0-b471-4b95c506ab7e"}, {"type": "CircleBufferGeometry", "name": "spotGeom", "uuid": "062a8b4a-0a2f-43fb-b655-47d8bff2a570", "radius": 0.0200025, "segments": 5}]};
</script>

    <script id="vshader" type="x-shader/x-vertex">
      precision highp float;
      uniform mat4 modelViewMatrix;
      uniform mat4 projectionMatrix;

      attribute vec3 position;
      attribute vec2 uv;
      attribute vec3 translate;

      varying vec2 vUv;

      void main() {

        vec4 mvPosition = modelViewMatrix * vec4( translate, 1.0 );
        vec3 z = normalize(-mvPosition.xyz);
        vec3 x = normalize(vec3(z.z, 0.0, -z.x));
        vec3 y = cross(z, x);
        mvPosition.xyz += position.x * x + position.y * y + position.z * z;
        vUv = uv;
        gl_Position = projectionMatrix * mvPosition;

      }
    </script>
    <script id="fshader" type="x-shader/x-fragment">
      precision highp float;

      uniform sampler2D map;

      varying vec2 vUv;

      void main() {
        vec4 diffuseColor = texture2D( map, vUv );
        gl_FragColor = diffuseColor;
        if ( diffuseColor.w < 0.5 ) discard;
      }
    </script>

  </head>

  <body onload="onLoad()">

    <canvas id="webgl-canvas"></canvas>

    <div id="overlay">

      <table><tr>
        <td>
          <h1>poolvr</h1>
          
<h3>v0.2.6</h3>
<table>
<tr>
<td>
<a href="https://github.com/jzitelli/poolvr/commit/1aeb06ba48c263986062703e779d5316852f9c2c">current commit</a>
</td>
<td>
<a href="https://github.com/jzitelli/poolvr/commit/9fdd50a4c3b364b8324e7fec1f96d919b90ba42c">previous commit</a>
</td>
</tr>
</table>

        </td>
      </tr></table>

      <h2>
        <button id="vrButton">toggle VR</button>
        <button id="fsButton">toggle fullscreen</button>
      </h2>

      <div class="panel" id="graphicsPanel" style="float: left">
      <h3>Graphics:</h3>
        <label>
          <input type="checkbox" id="useBasicMaterials"/>
          EGA mode (max performance)
        </label>
        <br>
        <label>
          <input type="checkbox" id="useSpotLight"/>
          Spot light
        </label>
        <label>
          <input type="checkbox" id="usePointLight"/>
          Point light
        </label>
        <br>
        <label>
          <input type="checkbox" id="useShadowMap"/>
          Shadow maps
        </label>
      </div>

      <div class="panel" id="leapPanel" style="float: left">
        <h3>Leap Motion:</h3>
        <label>
          Websocket address:
          <input id="leapAddress" type="text" maxlength="18" />
        </label>
        <span id="leapIndicator">
          disconnected
        </span>
      </div>

      

    </div>


    <script src="node_modules/three/build/three.js"></script>

    <script src="node_modules/three/examples/js/effects/VREffect.js"></script>
    <script src="node_modules/three/examples/js/controls/VRControls.js"></script>
    <script src="node_modules/three/examples/js/objects/ShadowMesh.js"></script>
    <script src="node_modules/three/examples/js/loaders/OBJLoader.js"></script>

    <script src="node_modules/stats.js/build/stats.min.js"></script>

    <script src="node_modules/leapjs/leap-0.6.4.min.js"></script>

    <script src="node_modules/webvr-polyfill/build/webvr-polyfill.js"></script>

    <script src="node_modules/cannon/build/cannon.min.js"></script>

    <script src="node_modules/three.py/js/three.py.js"></script>
    <script src="node_modules/three.py/js/CANNONize.js"></script>


    <script src="build/poolvr.js"></script>


  </body>

</html>